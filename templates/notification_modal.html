<!-- Notifications Modal -->
<div id="notificationModal" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center z-50">
  <div class="bg-white rounded-2xl shadow-2xl p-6 w-96 max-h-[80vh] overflow-y-auto">
    <h2 class="text-xl font-semibold mb-4 text-blue-600 flex justify-between items-center">
      Notifications
      <button id="closeNotificationModal" class="text-gray-500 hover:text-gray-700">&times;</button>
    </h2>
    <div id="notificationList" class="space-y-2">
      <p class="text-gray-500 text-sm">Loading...</p>
    </div>
  </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const modal = document.getElementById('notificationModal');
  const list = document.getElementById('notificationList');

  document.getElementById('notificationBtn')?.addEventListener('click', () => {
    modal.classList.remove('hidden');
    loadNotifications();
  });

  document.getElementById('closeNotificationModal')?.addEventListener('click', () => {
    modal.classList.add('hidden');
  });

  async function loadNotifications() {
    try {
      const res = await fetch("{{ url_for('notification_bp.get_notifications') }}");
      const data = await res.json();
      list.innerHTML = '';

      if (!data.length) {
        list.innerHTML = '<p class="text-gray-500 text-sm">No notifications yet.</p>';
        return;
      }

      data.forEach(n => {
        const div = document.createElement('div');
        div.className = "p-2 border-b border-gray-200 text-sm";
        div.innerHTML = `
          <p><strong>${n.user_name || 'Unknown'}</strong> ${n.action}</p>
          <p class="text-gray-500 text-xs">${new Date(n.created_at).toLocaleString()}</p>
        `;
        list.appendChild(div);
      });
    } catch (err) {
      console.error('Error loading notifications:', err);
      list.innerHTML = '<p class="text-red-500 text-sm">Failed to load notifications.</p>';
    }
  }
});
</script>

